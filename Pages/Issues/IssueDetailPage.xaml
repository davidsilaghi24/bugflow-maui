<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:behaviors="clr-namespace:BugFlow.Behaviors"
             x:Class="BugFlow.Pages.Issues.IssueDetailPage"
             Title="Detalii issue"
             BackgroundColor="{StaticResource PageBackground}">

    <Grid>
        <ActivityIndicator x:Name="loadingIndicator"
                           IsRunning="False" IsVisible="False"
                           Color="{StaticResource Primary}"
                           VerticalOptions="Center" HorizontalOptions="Center"
                           HeightRequest="50" WidthRequest="50" />

        <ScrollView x:Name="formContent" Padding="16" IsVisible="False">
            <VerticalStackLayout Spacing="14">

                <Frame Padding="16" CornerRadius="12" BackgroundColor="{StaticResource CardBackground}"
                       BorderColor="Transparent" HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Titlu *" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <Entry x:Name="titluEntry" Placeholder="Titlul issue-ului"
                               TextChanged="OnFormChanged">
                            <Entry.Behaviors>
                                <behaviors:ValidationBehavior />
                            </Entry.Behaviors>
                        </Entry>

                        <Label Text="Descriere *" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <Editor x:Name="descriereEditor" Placeholder="Descriere detaliata"
                                HeightRequest="100" TextChanged="OnFormChanged">
                            <Editor.Behaviors>
                                <behaviors:ValidationBehavior />
                            </Editor.Behaviors>
                        </Editor>
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="16" CornerRadius="12" BackgroundColor="{StaticResource CardBackground}"
                       BorderColor="Transparent" HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Prioritate" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <HorizontalStackLayout Spacing="6">
                            <Button x:Name="prioritateLowBtn" Text="Low" Clicked="OnPrioritateClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                            <Button x:Name="prioritateMediumBtn" Text="Medium" Clicked="OnPrioritateClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                            <Button x:Name="prioritateHighBtn" Text="High" Clicked="OnPrioritateClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                        </HorizontalStackLayout>
                        <Label Text="Stare" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <HorizontalStackLayout Spacing="6">
                            <Button x:Name="statusToDoBtn" Text="To Do" Clicked="OnStatusIssueClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                            <Button x:Name="statusInProgressBtn" Text="In Progress" Clicked="OnStatusIssueClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                            <Button x:Name="statusReviewBtn" Text="Review" Clicked="OnStatusIssueClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                            <Button x:Name="statusDoneBtn" Text="Done" Clicked="OnStatusIssueClicked" CornerRadius="8" Padding="14,7" FontSize="13" />
                        </HorizontalStackLayout>

                        <Label Text="Data Estimata" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <DatePicker x:Name="dataEstimataPicker">
                            <DatePicker.Behaviors>
                                <behaviors:FutureDateValidationBehavior />
                            </DatePicker.Behaviors>
                        </DatePicker>
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="16" CornerRadius="12" BackgroundColor="{StaticResource CardBackground}"
                       BorderColor="Transparent" HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Proiect *" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <Label x:Name="proiectLabel" FontSize="15" TextColor="{StaticResource Gray900}"
                               Text="(neselectat)" />
                        <Picker x:Name="proiectPicker" Title="Schimba proiectul..."
                                ItemDisplayBinding="{Binding Nume}"
                                SelectedIndexChanged="OnProiectChanged" />

                        <BoxView HeightRequest="1" Color="{StaticResource SurfaceBorder}" />

                        <Label Text="Asignat la" FontAttributes="Bold" TextColor="{StaticResource Gray600}" FontSize="13" />
                        <Label x:Name="membruLabel" FontSize="15" TextColor="{StaticResource Gray900}"
                               Text="(neasignat)" />
                        <Picker x:Name="membruPicker" Title="Schimba membrul..."
                                ItemDisplayBinding="{Binding NumeComplet}"
                                SelectedIndexChanged="OnMembruChanged" />
                    </VerticalStackLayout>
                </Frame>

                <Button x:Name="comentariiButton" Text="Vezi Comentariile"
                        Clicked="OnComentariiClicked"
                        BackgroundColor="{StaticResource Primary}" TextColor="White"
                        CornerRadius="10" IsVisible="False" />

                <Grid ColumnDefinitions="*, *" ColumnSpacing="15">
                    <Button x:Name="saveButton" Text="Salveaza"
                            Clicked="OnSaveClicked" BackgroundColor="{StaticResource Success}" TextColor="White"
                            CornerRadius="10" IsEnabled="False" />
                    <Button Grid.Column="1" Text="Sterge"
                            Clicked="OnDeleteClicked" BackgroundColor="{StaticResource Danger}" TextColor="White"
                            CornerRadius="10" />
                </Grid>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
