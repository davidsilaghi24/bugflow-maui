<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BugFlow.Pages.Comentarii.ComentariiListPage"
             Title="Comentarii"
             BackgroundColor="{StaticResource PageBackground}">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Adauga" Clicked="OnAdaugaClicked" />
    </ContentPage.ToolbarItems>

    <Grid RowDefinitions="Auto, *">
        <SearchBar x:Name="searchBar" Placeholder="Cauta comentariu..."
                   TextChanged="OnSearchTextChanged"
                   CancelButtonColor="{StaticResource Primary}"
                   BackgroundColor="{StaticResource CardBackground}" />

        <ActivityIndicator x:Name="loadingIndicator" Grid.Row="1"
                           IsRunning="False" IsVisible="False"
                           Color="{StaticResource Primary}"
                           VerticalOptions="Center" HorizontalOptions="Center"
                           HeightRequest="50" WidthRequest="50" />

        <VerticalStackLayout x:Name="emptyState" Grid.Row="1"
                             IsVisible="False"
                             VerticalOptions="Center" HorizontalOptions="Center"
                             Spacing="8" Padding="30">
            <Label Text="&#x1F4AC;" FontSize="48" HorizontalTextAlignment="Center" />
            <Label x:Name="emptyLabel" Text="Nu exista inca comentarii" FontSize="18" FontAttributes="Bold"
                   TextColor="{StaticResource Gray600}" HorizontalTextAlignment="Center" />
            <Label Text="Apasa Adauga pentru a scrie un comentariu."
                   FontSize="14" TextColor="{StaticResource Gray400}" HorizontalTextAlignment="Center" />
        </VerticalStackLayout>

        <RefreshView Grid.Row="1" x:Name="refreshView" Refreshing="OnRefreshing">
            <ListView x:Name="listView"
                      HasUnevenRows="True"
                      ItemSelected="OnItemSelected"
                      SeparatorVisibility="None"
                      BackgroundColor="Transparent">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>
                            <Frame Margin="12,6" Padding="0" CornerRadius="12"
                                   BackgroundColor="{StaticResource CardBackground}"
                                   BorderColor="Transparent" HasShadow="True">
                                <VerticalStackLayout Padding="16,14" Spacing="6">
                                    <Label Text="{Binding Text}" FontSize="15"
                                           TextColor="{StaticResource Gray900}"
                                           LineBreakMode="TailTruncation" MaxLines="3" />
                                    <Label Text="{Binding Data, StringFormat='{0:dd.MM.yyyy HH:mm}'}"
                                           FontSize="12" TextColor="{StaticResource Gray400}" />
                                </VerticalStackLayout>
                            </Frame>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </RefreshView>
    </Grid>
</ContentPage>
